{% extends "base.html" %}

{% block content %}

{% if current_user.is_authenticated %}
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"> </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.js"> </script>
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/ui-lightness/jquery-ui.css" rel="stylesheet" type="text/css" />
</head>

<h1>Your recent purchases:</h1>

<br/>

<h3>Search by</h3>
<form action="{{ url_for('users.purchase_history') }}" method="POST">
    by seller
    <input type="text" name="seller" id="tags_seller">
    by prodoct
    <input type="text" name="item" id="tags_item">
    <script>
    $( function() {
        var availableSellers = [
            {% for s in potential_sellers %}
                "{{s}}",
            {% endfor %}
        ];
        var availableItems = [
            {% for s in potential_items %}
                "{{s}}",
            {% endfor %}
        ];
        $( "#tags_seller" ).autocomplete({
            source: availableSellers
        });
        $( "#tags_item" ).autocomplete({
            source: availableItems
        });

    });
    </script>
    

    <input type = "submit" value = "submit" />

</form>

<table class='table table-hover table-bordered container'>
  <thead class="thead-dark">
    <tr>
      <th scope="col">Order ID</th>
      <th scope="col">Product</th>
      <th scope="col">Quantity</th>
      <th scope="col">Price</th>
      <th scope="col">Seller</th>
      <th scope="col">Fulfillment</th>
      <th scope="col">Purchase Time</th>
      <th scope="col">Detail</th>
    </tr>
  </thead>
  <tbody>
    {% for p in purchase%}
      <tr>
        <th scope="row">{{p.oid}}</th>
        <th scope="row">{{p.product}}</th>
        <td>{{p.quantity}}</td>
        <td>{{p.price}}</td>
        <td>{{p.sname}}</td>
        <td>{{p.completed_status}}</td>
        <td>{{p.time_purchased}}</td>
        <td></td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

{% endblock %}
